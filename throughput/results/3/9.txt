BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%salmon%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 270842133.634698
 ALGERIA                   |   1997 |  457650926.32703
 ALGERIA                   |   1996 | 464470610.539987
 ALGERIA                   |   1995 | 460680727.221518
 ALGERIA                   |   1994 | 459160027.248079
 ALGERIA                   |   1993 | 457113695.133376
 ALGERIA                   |   1992 |  455762681.87241
 ARGENTINA                 |   1998 | 270471643.467476
 ARGENTINA                 |   1997 | 454668312.355079
 ARGENTINA                 |   1996 |  462555084.33435
 ARGENTINA                 |   1995 | 461947848.550968
 ARGENTINA                 |   1994 | 467414419.553359
 ARGENTINA                 |   1993 |  455740907.12305
 ARGENTINA                 |   1992 | 462805576.309203
 BRAZIL                    |   1998 |  268305739.02366
 BRAZIL                    |   1997 | 457708308.879619
 BRAZIL                    |   1996 |  457584940.70934
 BRAZIL                    |   1995 | 472199176.700778
 BRAZIL                    |   1994 |  459458712.94805
 BRAZIL                    |   1993 | 457375665.417171
 BRAZIL                    |   1992 | 464529367.350875
 CANADA                    |   1998 | 279789631.321227
 CANADA                    |   1997 | 470659610.307417
 CANADA                    |   1996 | 476227069.813022
 CANADA                    |   1995 | 473743002.698629
 CANADA                    |   1994 | 474152573.861063
 CANADA                    |   1993 | 478761333.678116
 CANADA                    |   1992 | 474173465.203876
 CHINA                     |   1998 | 274206350.858793
 CHINA                     |   1997 | 464946922.422693
 CHINA                     |   1996 | 466960684.095874
 CHINA                     |   1995 | 461450764.579926
 CHINA                     |   1994 | 473297718.768314
 CHINA                     |   1993 | 466534247.127469
 CHINA                     |   1992 | 463867146.619903
 EGYPT                     |   1998 | 281417738.443378
 EGYPT                     |   1997 | 473608303.984847
 EGYPT                     |   1996 | 473286284.972201
 EGYPT                     |   1995 | 469510286.220721
 EGYPT                     |   1994 | 468998545.590921
 EGYPT                     |   1993 | 476318759.326412
 EGYPT                     |   1992 | 468659609.894347
 ETHIOPIA                  |   1998 | 262511991.766461
 ETHIOPIA                  |   1997 | 445853197.263336
 ETHIOPIA                  |   1996 | 447944392.059873
 ETHIOPIA                  |   1995 | 445981245.356717
 ETHIOPIA                  |   1994 | 443963028.108109
 ETHIOPIA                  |   1993 | 447127975.471764
 ETHIOPIA                  |   1992 | 448562870.417701
 FRANCE                    |   1998 | 267949594.978195
 FRANCE                    |   1997 | 460012489.917564
 FRANCE                    |   1996 | 462691450.357726
 FRANCE                    |   1995 | 455420766.449664
 FRANCE                    |   1994 | 461905422.226745
 FRANCE                    |   1993 | 461902470.166373
 FRANCE                    |   1992 |  459590078.34719
 GERMANY                   |   1998 | 273445919.074893
 GERMANY                   |   1997 | 477076478.113109
 GERMANY                   |   1996 | 480447320.340064
 GERMANY                   |   1995 |  472562567.24916
 GERMANY                   |   1994 | 480097178.514599
 GERMANY                   |   1993 | 476428154.030521
 GERMANY                   |   1992 | 479927138.728447
 INDIA                     |   1998 | 267765413.778113
 INDIA                     |   1997 | 473792872.731243
 INDIA                     |   1996 | 471605553.223522
 INDIA                     |   1995 | 471313995.221254
 INDIA                     |   1994 | 464739439.670305
 INDIA                     |   1993 |  473775638.46442
 INDIA                     |   1992 | 477616727.541939
 INDONESIA                 |   1998 | 269742268.119844
 INDONESIA                 |   1997 | 464130932.995338
 INDONESIA                 |   1996 | 461909832.605385
 INDONESIA                 |   1995 | 456483926.903466
 INDONESIA                 |   1994 |  456367190.50123
 INDONESIA                 |   1993 | 463447781.741463
 INDONESIA                 |   1992 | 463852399.427885
 IRAN                      |   1998 | 270302020.778924
 IRAN                      |   1997 | 468724111.620103
 IRAN                      |   1996 | 457438953.332077
 IRAN                      |   1995 | 463232824.739903
 IRAN                      |   1994 | 458745941.921961
 IRAN                      |   1993 |  465355458.54836
 IRAN                      |   1992 | 464472220.207078
 IRAQ                      |   1998 | 279086314.901207
 IRAQ                      |   1997 | 467483957.172466
 IRAQ                      |   1996 | 481056485.963808
 IRAQ                      |   1995 | 476158317.893582
 IRAQ                      |   1994 | 479281286.538301
 IRAQ                      |   1993 | 477512286.613369
 IRAQ                      |   1992 | 466070641.056604
 JAPAN                     |   1998 | 265767199.070869
 JAPAN                     |   1997 | 466931321.132091
 JAPAN                     |   1996 | 471158003.815661
 JAPAN                     |   1995 | 466179094.963048
 JAPAN                     |   1994 | 455709420.470784
 JAPAN                     |   1993 | 464170841.848946
 JAPAN                     |   1992 | 461432340.407742
 JORDAN                    |   1998 | 268449793.776929
 JORDAN                    |   1997 | 454538286.239234
 JORDAN                    |   1996 | 454892336.127162
 JORDAN                    |   1995 | 459483308.297196
 JORDAN                    |   1994 | 456054342.692045
 JORDAN                    |   1993 | 452722709.552414
 JORDAN                    |   1992 | 457732336.625209
 KENYA                     |   1998 | 269338760.503543
 KENYA                     |   1997 | 472347277.758956
 KENYA                     |   1996 |  462445622.20455
 KENYA                     |   1995 | 473237381.167709
 KENYA                     |   1994 | 469800424.424375
 KENYA                     |   1993 | 467447630.221195
 KENYA                     |   1992 |  465359263.98211
 MOROCCO                   |   1998 | 270524997.108921
 MOROCCO                   |   1997 | 463550887.051014
 MOROCCO                   |   1996 | 467193960.909595
 MOROCCO                   |   1995 | 465626642.055337
 MOROCCO                   |   1994 | 470768720.843385
 MOROCCO                   |   1993 | 464183375.451823
 MOROCCO                   |   1992 | 464209930.254096
 MOZAMBIQUE                |   1998 | 274693052.957592
 MOZAMBIQUE                |   1997 | 463766166.787211
 MOZAMBIQUE                |   1996 | 465639044.784525
 MOZAMBIQUE                |   1995 | 457322175.635917
 MOZAMBIQUE                |   1994 | 456384454.695862
 MOZAMBIQUE                |   1993 | 463489234.827336
 MOZAMBIQUE                |   1992 | 459793073.612576
 PERU                      |   1998 |    267716457.085
 PERU                      |   1997 | 464272734.614627
 PERU                      |   1996 | 458299349.209564
 PERU                      |   1995 | 459471114.168396
 PERU                      |   1994 | 454753516.503554
 PERU                      |   1993 | 459400264.286129
 PERU                      |   1992 | 457210439.599753
 ROMANIA                   |   1998 | 273963570.212309
 ROMANIA                   |   1997 | 463120055.989581
 ROMANIA                   |   1996 | 472029248.931121
 ROMANIA                   |   1995 | 463630662.827454
 ROMANIA                   |   1994 | 461795437.530489
 ROMANIA                   |   1993 | 462269127.718008
 ROMANIA                   |   1992 | 458848142.366225
 RUSSIA                    |   1998 | 280015721.307454
 RUSSIA                    |   1997 | 467475993.453101
 RUSSIA                    |   1996 | 473194347.610071
 RUSSIA                    |   1995 | 470050190.171578
 RUSSIA                    |   1994 | 472020351.328912
 RUSSIA                    |   1993 | 470721127.575113
 RUSSIA                    |   1992 | 475784955.581296
 SAUDI ARABIA              |   1998 | 275240813.894441
 SAUDI ARABIA              |   1997 | 458056473.942173
 SAUDI ARABIA              |   1996 | 459676383.172038
 SAUDI ARABIA              |   1995 | 454957418.982222
 SAUDI ARABIA              |   1994 | 458811340.219095
 SAUDI ARABIA              |   1993 | 464329745.769262
 SAUDI ARABIA              |   1992 | 466272483.564877
 UNITED KINGDOM            |   1998 | 262719204.096265
 UNITED KINGDOM            |   1997 | 456134755.948916
 UNITED KINGDOM            |   1996 | 458432014.595108
 UNITED KINGDOM            |   1995 | 459012181.978707
 UNITED KINGDOM            |   1994 | 446841423.624062
 UNITED KINGDOM            |   1993 | 457317320.701042
 UNITED KINGDOM            |   1992 | 452811075.064361
 UNITED STATES             |   1998 | 279816788.437756
 UNITED STATES             |   1997 | 471890089.662333
 UNITED STATES             |   1996 | 471355814.344068
 UNITED STATES             |   1995 | 467682681.636686
 UNITED STATES             |   1994 | 473157193.330106
 UNITED STATES             |   1993 | 474113578.296084
 UNITED STATES             |   1992 | 465242242.095261
 VIETNAM                   |   1998 |  266123838.95626
 VIETNAM                   |   1997 | 463420534.585839
 VIETNAM                   |   1996 | 464932735.711726
 VIETNAM                   |   1995 | 464805883.850628
 VIETNAM                   |   1994 | 470146631.250786
 VIETNAM                   |   1993 | 469738670.478227
 VIETNAM                   |   1992 | 472394315.119314
(175 rows)

COMMIT;
COMMIT
